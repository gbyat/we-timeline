(()=>{var e={261(e,t,l){"use strict";l(739),function(){function e(e,t){if("items"===t)return e.map(e=>({label:e.title,value:e.id,type:"item"}));const l={};return e.forEach(e=>{const n=new Date(e.date);let i;if("decades"===t){const e=n.getFullYear();i=10*Math.floor(e/10)}else"years"===t?i=n.getFullYear():"months"===t&&(i=`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`);l[i]||(l[i]=[]),l[i].push(e)}),Object.keys(l).sort().map(e=>{const n=new Date(l[e][0].date);let i;return"decades"===t?i=`${parseInt(e)}s`:"years"===t?i=e:"months"===t&&(i=n.toLocaleDateString("en-US",{month:"long",year:"numeric"})),{label:i,value:e,type:t.slice(0,-1),items:l[e]}})}function t(e){const t=document.querySelector(`.we-timeline__item[data-id="${e}"]`);t&&t.scrollIntoView({behavior:"smooth",block:"center"})}document.querySelectorAll(".wp-block-we-timeline-timeline .we-timeline-menu:not(.processed)").forEach(l=>{l.classList.add("processed");const n=l.dataset.granularity||"auto",i=l.closest(".wp-block-we-timeline-timeline");if(!i)return;const o=i.querySelectorAll(".we-timeline__item");if(0===o.length)return;const a=l.querySelector(".we-timeline-menu__items");if(!a)return;const r=function(t,l){const n=(l||"auto").toLowerCase().trim(),i=Array.from(t).map(e=>{const t=e.dataset.date;return{id:e.dataset.id,date:t,title:e.querySelector(".we-timeline__item-title")?.textContent||"",timestamp:new Date(t).getTime()}});return"auto"===n?function(t){if(0===t.length)return[];const l=t.map(e=>e.timestamp),n=Math.min(...l),i=(Math.max(...l)-n)/31536e6;return i<1?t.map(e=>({label:e.title,value:e.id,type:"item"})):e(t,i<=5?"months":"years")}(i):e(i,n)}(o,n);!function(e,l){e&&(e.innerHTML="",l.forEach(l=>{const n=document.createElement("button");n.className="we-timeline-menu__item",n.textContent=l.label,n.dataset.value=l.value,n.dataset.type=l.type,l.items?n.addEventListener("click",()=>{var e;0!==(e=l.items).length&&t(e[0].id)}):n.addEventListener("click",()=>{t(l.value)}),e.appendChild(n)}))}(a,r),function(e,t){const l=e.querySelector(".we-timeline-menu__items");if(!l)return;const n=Array.from(l.querySelectorAll(".we-timeline-menu__item"));function i(){const e=function(){const e=window.innerHeight,l=e/3;let n=null,i=1/0;return t.forEach(t=>{const o=t.getBoundingClientRect(),a=o.top+o.height/2,r=Math.abs(a-l);o.bottom>0&&o.top<e&&r<i&&(i=r,n=t)}),n}();if(!e)return;const i=e.dataset.id,o=e.dataset.date;t.forEach(e=>{e.classList.remove("is-active")}),e.classList.add("is-active");let a=null;if(a=l.querySelector(`[data-value="${i}"]`),!a&&o){const e=new Date(o),t=e.getFullYear(),l=e.getMonth()+1,r=10*Math.floor(t/10);n.forEach(e=>{const n=e.dataset.type,o=e.dataset.value;("item"===n&&o===i||"year"===n&&parseInt(o)===t||"month"===n&&o===`${t}-${String(l).padStart(2,"0")}`||"decade"===n&&parseInt(o)===r)&&(a=e)})}n.forEach(e=>{e.classList.remove("is-active")}),a&&a.classList.add("is-active")}let o=!1;function a(){o||(window.requestAnimationFrame(()=>{i(),o=!1}),o=!0)}window.addEventListener("scroll",a,{passive:!0}),window.addEventListener("resize",a,{passive:!0}),i()}(l,o)})}()},739(){document.querySelectorAll(".wp-block-we-timeline-timeline.we-timeline--vertical-alternating, .wp-block-we-timeline-timeline.we-timeline--vertical-left, .wp-block-we-timeline-timeline.we-timeline--vertical-right").forEach(e=>{const t=e.querySelector(".we-timeline__items");if(!t)return;const l=t;if(0===t.querySelectorAll(".we-timeline__item").length)return;function n(){const e=t.getBoundingClientRect(),n=e.top+window.scrollY,i=e.bottom+window.scrollY,o=window.scrollY+window.innerHeight/3,a=i-n;if(o<n)return void l.style.setProperty("--progress-height","0%");if(o>i)return void l.style.setProperty("--progress-height","100%");const r=100*Math.max(0,Math.min(1,(o-n)/a));l.style.setProperty("--progress-height",r+"%")}let i=!1;function o(){i||(window.requestAnimationFrame(()=>{n(),i=!1}),i=!0)}window.addEventListener("scroll",o,{passive:!0}),window.addEventListener("resize",o,{passive:!0}),n()})}},t={};function l(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={exports:{}};return e[n](o,o.exports,l),o.exports}l.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return l.d(t,{a:t}),t},l.d=(e,t)=>{for(var n in t)l.o(t,n)&&!l.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";const e=window.wp.blocks,t=window.wp.blockEditor,n=window.React,i=window.wp.i18n,o=window.wp.element,a=window.wp.components,r=window.wp.data,s=window.wp.serverSideRender;var m=l.n(s);const c=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","apiVersion":3,"name":"we-timeline/timeline","title":"Timeline","category":"widgets","icon":"calendar-alt","description":"Display content in a timeline layout with various options.","keywords":["timeline","history","events"],"textdomain":"we-timeline","supports":{"align":["wide","full"],"html":false,"color":{"text":true,"background":true,"link":true,"__experimentalDefaultControls":{"text":true,"background":true,"link":true}}},"attributes":{"layout":{"type":"string","default":"vertical"},"position":{"type":"string","default":"left"},"visibleItems":{"type":"number","default":3},"icon":{"type":"string","default":"calendar-alt"},"iconSize":{"type":"string","default":"medium"},"postType":{"type":"string","default":"post"},"taxonomy":{"type":"string","default":""},"term":{"type":"integer","default":0},"dateField":{"type":"string","default":"date"},"sortOrder":{"type":"string","default":"asc"},"excludeFromMainLoop":{"type":"boolean","default":false},"excludeFromCategoryLists":{"type":"boolean","default":false},"showMenu":{"type":"boolean","default":false},"menuGranularity":{"type":"string","default":"auto"},"timelineLineColor":{"type":"string","default":""},"timelineLineActiveColor":{"type":"string","default":""},"itemBackgroundColor":{"type":"string","default":""},"itemBorderRadius":{"type":"string","default":""},"iconColor":{"type":"string","default":""},"dateColor":{"type":"string","default":""}},"editorScript":"file:./index.js","editorStyle":"file:./index.css","style":"file:./index.css","viewScript":"file:./view.js","render":"file:./render.php"}');l(261),l(739),(0,e.registerBlockType)(c.name,{...c,edit:function({attributes:e,setAttributes:l}){const{layout:s,position:c,visibleItems:u,icon:d,iconSize:p,postType:w,taxonomy:_,term:g,dateField:v,sortOrder:b,excludeFromMainLoop:y,excludeFromCategoryLists:f,showMenu:h,menuGranularity:C,timelineLineColor:S,timelineLineActiveColor:E,itemBackgroundColor:k,itemBorderRadius:x,iconColor:L,dateColor:M}=e;(0,o.useEffect)(()=>{w||l({postType:"post"})},[w,l]),(0,o.useEffect)(()=>{s&&!c&&l({position:"vertical"===s?"left":"horizontal-scroll"===s?"top":"left"})},[s,c,l]);const T=(0,t.useBlockProps)({className:"we-timeline",style:{}}),F=(0,r.useSelect)(e=>{const t=e("core").getPostTypes({per_page:-1});return t?t.filter(e=>e.viewable&&"attachment"!==e.slug).map(e=>({label:e.name,value:e.slug})):[]},[]),I=(0,r.useSelect)(e=>{if(!w)return[];const t=e("core").getTaxonomies({per_page:-1});return t?t.filter(e=>e.types.includes(w)).map(e=>({label:e.name,value:e.slug})):[]},[w]),B=(0,r.useSelect)(e=>{if(!_)return[];const t=e("core").getEntityRecords("taxonomy",_,{per_page:-1});return t?t.map(e=>({label:e.name,value:e.id})):[]},[_]),P=((0,r.useSelect)(e=>e("core/block-editor").getSettings(),[]),[{label:(0,i.__)("Timeline Line Color","we-timeline"),value:S||"",onChange:e=>l({timelineLineColor:e||""})},{label:(0,i.__)("Timeline Line Active Color","we-timeline"),value:E||"",onChange:e=>l({timelineLineActiveColor:e||""})},{label:(0,i.__)("Item Background Color","we-timeline"),value:k||"",onChange:e=>l({itemBackgroundColor:e||""})},{label:(0,i.__)("Icon Color","we-timeline"),value:L||"",onChange:e=>l({iconColor:e||""})},{label:(0,i.__)("Date Color","we-timeline"),value:M||"",onChange:e=>l({dateColor:e||""})}]);return(0,n.createElement)(n.Fragment,null,(0,n.createElement)(t.BlockControls,{group:"other"}),(0,n.createElement)(t.InspectorControls,{group:"styles"},t.PanelColorSettings&&(0,n.createElement)(t.PanelColorSettings,{title:(0,i.__)("Timeline Colors","we-timeline"),colorSettings:P}),(0,n.createElement)(a.PanelBody,{title:(0,i.__)("Timeline Styling","we-timeline"),initialOpen:!1},(0,n.createElement)(a.__experimentalInputControl,{label:(0,i.__)("Item Border Radius","we-timeline"),type:"text",value:x||"",onChange:e=>l({itemBorderRadius:e||""}),placeholder:"e.g., 8px, 0.5rem, 0",help:(0,i.__)("Enter a CSS value (e.g., 8px, 0.5rem, 0)","we-timeline")}))),(0,n.createElement)(t.InspectorControls,null,(0,n.createElement)(a.PanelBody,{title:(0,i.__)("Content Settings","we-timeline"),initialOpen:!0},(0,n.createElement)(a.SelectControl,{label:(0,i.__)("Layout","we-timeline"),value:s||"vertical",options:[{label:(0,i.__)("Vertical","we-timeline"),value:"vertical"},{label:(0,i.__)("Horizontal Scroll","we-timeline"),value:"horizontal-scroll"}],onChange:e=>{l({layout:e,position:"vertical"===e?"left":"top"})}}),"horizontal-scroll"!==s&&(0,n.createElement)(a.SelectControl,{label:(0,i.__)("Position","we-timeline"),value:c||"left",options:[{label:(0,i.__)("Left","we-timeline"),value:"left"},{label:(0,i.__)("Right","we-timeline"),value:"right"}],onChange:e=>l({position:e})}),"horizontal-scroll"===s&&(0,n.createElement)(n.Fragment,null,(0,n.createElement)(a.SelectControl,{label:(0,i.__)("Position","we-timeline"),value:c||"top",options:[{label:(0,i.__)("Top","we-timeline"),value:"top"},{label:(0,i.__)("Bottom","we-timeline"),value:"bottom"}],onChange:e=>l({position:e})}),(0,n.createElement)(a.SelectControl,{label:(0,i.__)("Visible Items","we-timeline"),value:u||3,options:[{label:"1",value:1},{label:"2",value:2},{label:"3",value:3},{label:"4",value:4},{label:"5",value:5},{label:"6",value:6}],onChange:e=>l({visibleItems:parseInt(e)})})),(0,n.createElement)(a.SelectControl,{label:(0,i.__)("Icon","we-timeline"),value:d||"calendar-alt",options:[{label:(0,i.__)("Calendar","we-timeline"),value:"calendar-alt"},{label:(0,i.__)("Clock","we-timeline"),value:"clock"},{label:(0,i.__)("Star","we-timeline"),value:"star-filled"},{label:(0,i.__)("Flag","we-timeline"),value:"flag"},{label:(0,i.__)("Marker","we-timeline"),value:"location"},{label:(0,i.__)("Circle","we-timeline"),value:"marker"},{label:(0,i.__)("Dot","we-timeline"),value:"dot"},{label:(0,i.__)("None","we-timeline"),value:""}],onChange:e=>l({icon:e})}),d&&(0,n.createElement)(a.SelectControl,{label:(0,i.__)("Icon Size","we-timeline"),value:p||"medium",options:[{label:(0,i.__)("Small","we-timeline"),value:"small"},{label:(0,i.__)("Medium","we-timeline"),value:"medium"},{label:(0,i.__)("Large","we-timeline"),value:"large"}],onChange:e=>l({iconSize:e})}),(0,n.createElement)(a.SelectControl,{label:(0,i.__)("Post Type","we-timeline"),value:w||"post",options:F.length>0?F:[{label:(0,i.__)("Loading...","we-timeline"),value:"post"}],onChange:e=>{l({postType:e,taxonomy:"",term:0})}}),(0,n.createElement)(n.Fragment,null,(0,n.createElement)(a.SelectControl,{label:(0,i.__)("Taxonomy","we-timeline"),value:_,options:[{label:(0,i.__)("All Posts","we-timeline"),value:""},...I],onChange:e=>{l({taxonomy:e,term:0})}}),_&&(0,n.createElement)(a.SelectControl,{label:(0,i.__)("Term","we-timeline"),value:g,options:[{label:(0,i.__)("All Terms","we-timeline"),value:0},...B],onChange:e=>l({term:parseInt(e)})})),(0,n.createElement)(a.SelectControl,{label:(0,i.__)("Date Field","we-timeline"),value:v,options:[{label:(0,i.__)("Post Date","we-timeline"),value:"date"},{label:(0,i.__)("Timeline Date (Custom Field)","we-timeline"),value:"timeline_date"}],onChange:e=>l({dateField:e})}),(0,n.createElement)(a.SelectControl,{label:(0,i.__)("Sort Order","we-timeline"),value:b,options:[{label:(0,i.__)("Ascending","we-timeline"),value:"asc"},{label:(0,i.__)("Descending","we-timeline"),value:"desc"}],onChange:e=>l({sortOrder:e})})),(0,n.createElement)(a.PanelBody,{title:(0,i.__)("Exclusion Settings","we-timeline")},_&&g>0&&(0,n.createElement)(n.Fragment,null,(0,n.createElement)(a.ToggleControl,{label:(0,i.__)("Exclude from Main Loop","we-timeline"),checked:y,onChange:e=>l({excludeFromMainLoop:e})}),(0,n.createElement)(a.ToggleControl,{label:(0,i.__)("Exclude from Category Lists","we-timeline"),checked:f,onChange:e=>l({excludeFromCategoryLists:e})}))),(0,n.createElement)(a.PanelBody,{title:(0,i.__)("Menu Settings","we-timeline")},(0,n.createElement)(a.ToggleControl,{label:(0,i.__)("Show Menu","we-timeline"),checked:h,onChange:e=>l({showMenu:e})}),h&&(0,n.createElement)(a.SelectControl,{label:(0,i.__)("Menu Granularity","we-timeline"),value:C||"auto",options:[{label:(0,i.__)("Auto","we-timeline"),value:"auto"},{label:(0,i.__)("Decades","we-timeline"),value:"decades"},{label:(0,i.__)("Years","we-timeline"),value:"years"},{label:(0,i.__)("Months","we-timeline"),value:"months"},{label:(0,i.__)("Items","we-timeline"),value:"items"}],onChange:e=>l({menuGranularity:e})}))),(0,n.createElement)("div",{...T},(0,n.createElement)(m(),{block:"we-timeline/timeline",attributes:{...e,postType:w||"post",layout:s||"vertical",position:c||("horizontal-scroll"===s?"top":"left"),visibleItems:u||3}})))},save:()=>(t.useBlockProps.save(),null)})})()})();